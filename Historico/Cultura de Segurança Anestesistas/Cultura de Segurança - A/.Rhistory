analise_grafica_pareada('27. Nesta unidade, discutimos maneiras de impedir que os erros tornem a acontecer', '27. In this unit, we discuss ways to prevent errors from happening again')
ggsave("Feedback e comunicação sobre erros2.png", height=11, width=30, units="cm", dpi= 600)
# Frequência de eventos relatados
analise_grafica_pareada('29. Quando acontece um erro, mas ele é identificado e corrigido antes de afetar o paciente, com que frequência é notificado?', '29. When a mistake is made, but is caught and corrected before affecting the patient, how often is this reported?') +
analise_grafica_pareada('30. Quando acontece um erro, mas que não tem potencial de dano ao paciente, com que frequência é notificado?', '30. When a mistake is made, but has no potential to harm the patient, how often is this reported?') +
analise_grafica_pareada('31. Quando acontece um erro que poderia prejudicar o paciente, mas isto não ocorreu, com que frequência é notificado?', '31. When a mistake is made that could harm the patient, but does not, how often is this reported?')
ggsave("Frequencia de eventos relatados2.png", height=13, width=30, units="cm", dpi= 600)
# Apoio de gestão hospitalar para segurança do paciente
analise_grafica_pareada('32. A administração do hospital cria um ambiente de trabalho que promove a segurança do paciente', '32. Hospital management supports my daily efforts to keep patients safe') +
analise_grafica_pareada('39. As ações da administração do hospital mostram que a segurança do paciente é uma prioridade máxima', '39. Hospital management is doing a good job of keeping patient safety a top priority') +
analise_grafica_pareada('40. A administração do hospital parece se interessar pela segurança do paciente apenas quando acontece um evento adverso', '40. Hospital management seems interested in patient safety only after an adverse event happens')
ggsave("Apoio de gestão hospitalar para seguraça do paciente2.png", height=11, width=30, units="cm", dpi= 600)
# Trabalho em equipe entre as unidades hospitalares
(analise_grafica_pareada('33. As unidades hospitalares não se coordenam bem entre si.', '33. Hospital units do not coordinate well with each other.') +
analise_grafica_pareada('35. Existe uma boa cooperação entre as unidades hospitalares que precisam trabalhar juntas', '35. There is good cooperation among hospital units that need to work together.') +
analise_grafica_pareada('37. Muitas vezes é desagradável trabalhar unidades com funcionários de outras unidades do hospital', '37. It is often unpleasant to work with staff from other hospital units.')) /
(analise_grafica_pareada('41. As unidades do hospital trabalham bem juntas para prestar o melhor atendimento aos pacientes', '41. Hospital units work well together to provide the best care for patients.') + ggplot() + ggplot())
ggsave("Trabalho em equipe entre as unidades hospitalares2.png", height=22, width=30, units="cm", dpi= 600)
# Trabalho em equipe no âmbito das unidades
(analise_grafica_pareada('1. As pessoas se apoiam umas às outras nesta unidade', '1. People support one another in this unit.') +
analise_grafica_pareada('3. Quando há muito trabalho a ser feito e rapidamente, trabalhamos juntos em equipe para realizar a tarefa', '3. When a lot of work needs to be done quickly, we work together as a team to get the work done.') +
analise_grafica_pareada('4. Nesta unidade, as pessoas se tratam com respeito', '4. In this unit, people treat each other with respect.')) /
(analise_grafica_pareada('11. Quando uma área nesta unidade fica muito movimentada, as demais ajudam', '11. When one area in this unit gets busy, others help out.') + ggplot() + ggplot())
ggsave("Trabalho em equipe no âmbito das unidades2.png", height=22, width=30, units="cm", dpi= 600)
# Transferências internas e passagens de plantão
(analise_grafica_pareada('34. Coisas "escapam por entre os dedos” quando os pacientes são transferidos de uma unidade para outra', '34. Things "fall through the cracks" when patients are transferred from one unit to another.') +
analise_grafica_pareada('36. Importantes informações sobre a assistência se perdem durante as mudanças de turno', '36. Important information about care gets lost during shift changes.') +
analise_grafica_pareada('38. Os problemas com frequência ocorrem na troca de informações entre as unidades do hospital', '38. Problems often occur in the exchange of information across hospital units.')) /
(analise_grafica_pareada('42. As mudanças de turno são problemáticas para os pacientes deste Hospital', '42. Shift changes are problematic for patients in this Hospital.') + ggplot() + ggplot())
ggsave("Transferências internas e passagens de plantão2.png", height=22, width=30, units="cm", dpi= 600)
# Aprendizado organizacional - melhoria contínua
analise_grafica_pareada('6. Estamos ativamente buscando melhorias para a segurança do paciente', '6. We are actively working to improve patient safety.') +
analise_grafica_pareada('9. Erros que ocorreram levaram a mudanças positivas nesta unidade', '9. Mistakes have led to positive changes in this unit.') +
analise_grafica_pareada('13. Quando fazemos mudanças para melhorar a segurança do paciente, nós avaliamos sua efetividade', '13. When we make changes to improve patient safety, we evaluate their effectiveness.')
ggsave("Aprendizado organizacional - melhoria contínua2.png", height=11, width=30, units="cm", dpi= 600)
#Expectativas de promoção da segurança dos supervisores e gerentes
(analise_grafica_pareada('19. Meu supervisor/gerente elogia quando vê um trabalho feito de acordo com os procedimentos estabelecidos para a segurança do paciente.', '19. My supervisor/manager praises when seeing a job done according to the established procedures for patient safety.') + analise_grafica_pareada('20. Meu supervisor/gerente considera seriamente as sugestões dos funcionários para melhorar a segurança do paciente', '20. My supervisor/manager seriously considers employee suggestions to improve patient safety.') + analise_grafica_pareada('21. Sempre que a pressão aumenta, meu supervisor/gerente quer que trabalhemos mais rápido, mesmo que isto signifique tomar atalhos', '21. Whenever pressure increases, my supervisor/manager wants us to work faster, even if it means taking shortcuts.')) /
(analise_grafica_pareada('22. Meu supervisor/gerente ignora problemas recorrentes na segurança do paciente', '22. My supervisor/manager ignores recurring patient safety issues.') + ggplot() + ggplot())
ggsave("Expectativas de promoção da segurança dos supervisores e gerentes2.png", height=22, width=30, units="cm", dpi= 600)
#Percepção gerais sobre segurança
(analise_grafica_pareada('10. É apenas por acaso que erros mais sérios não acontecem por aqui', '10. It is just by chance that more serious errors do not happen here.') + analise_grafica_pareada('15. A segurança do paciente nunca é sacrificada em prol de se trabalhar mais', '15. Patient safety is never sacrificed for the sake of working more.') + analise_grafica_pareada('17. Temos problemas com a segurança do paciente nesta unidade', '17. We have problems with patient safety in this unit.')) /
(analise_grafica_pareada('18. Nossos procedimentos e sistemas são bons para impedir que os erros aconteçam', '18. Our procedures and systems are good at preventing errors from happening.') + ggplot() + ggplot())
ggsave("Percepção gerais sobre segurança2.png", height=22, width=30, units="cm", dpi= 600)
#Respostas não punitivas aos erros
analise_grafica_pareada('8. Os funcionários sentem que seus erros são usados contra eles', '8. Staff feel that their mistakes are held against them.') +
analise_grafica_pareada('12. Quando um evento é notificado, sentimos que o foco se concentra no indivíduo, e não no problema', '12. When an event is reported, it feels as if the focus is on the person, not the issue.') +
analise_grafica_pareada('16. Os funcionários se preocupam que seus erros sejam registrados em seu arquivo funcional', '16. Staff worry that their mistakes are kept in their personnel file.')
ggsave("Respostas não punitivas aos erros2.png", height=11, width=30, units="cm", dpi= 600)
#Staffing
(analise_grafica_pareada('2. Temos pessoas suficientes para lidar com o volume de trabalho', '2. We have enough staff to handle the workload.') +
analise_grafica_pareada('5. Os funcionários desta unidade trabalham mais horas do que o recomendado no atendimento a pacientes', '5. Staff in this unit work longer hours than is best for patient care.') +
analise_grafica_pareada('7. Utilizamos mais funcionários temporários do que o recomendado no atendimento a paciente', '7. We use more temporary staff than is best for patient care.')) /
(analise_grafica_pareada('14. Trabalhamos “em modo de crise”, tentando fazer coisas demais, rápido demais', '14. We work in "crisis mode", trying to do too much, too quickly.') + ggplot() + ggplot())
ggsave("Staffing2.png", height=22, width=30, units="cm", dpi= 600)
df_progresso = df %>% filter(passou_a_ser_acreditado == 1)
analise_grafica_pareada = function(coluna, titulo){
df_pareado = df_progresso %>% group_by(Unidade, acreditacao) %>% summarise(score = mean(!!sym(coluna)))
df_pareado$acreditacao = factor(df_pareado$acreditacao, levels = c('No Accreditation', 'Accreditation'))
grupo = df_pareado$score
grupo0 = df_pareado$score[df_pareado$acreditacao == 'No Accreditation']
grupo1 = df_pareado$score[df_pareado$acreditacao == 'Accreditation']
#Teste de Hipotese - Teste Mann Whitney
teste_man = wilcox.test(grupo1,grupo0,conf.int = TRUE, paired=T)
man = retorne_p2(teste_man$p.value)
#Estimador Hodges Lehmann
estimador = as.character(round(teste_man$estimate,2))
IC_00 = as.character(round(teste_man$conf.int[1],2))
IC_01 = as.character(round(teste_man$conf.int[2],2))
hodges_lehmann = paste0(estimador,' [',IC_00,' to ',IC_01,']')
##Coeficiente r
##df_pareado[[coluna]] = 1 - df_pareado[[coluna]]
#teste = wilcoxonR(df_pareado$score, g=df_pareado$acreditacao, ci=T)
##df_pareado[[coluna]] = 1 - df_pareado[[coluna]]
#r = as.character(round(teste[1],2))
#r_ic0 = as.character(round(teste[2],2))
#r_ic1 = as.character(round(teste[3],2))
#r = paste0(r,' (',r_ic0,' to ',r_ic1,')')
#texto_dentro_do_grafico = paste0(man, '\n', "Diff in Location = ", hodges_lehmann, '\n', 'r = ', r)
texto_dentro_do_grafico = paste0(man)
eixo_x = paste0("Diff in Location = ", hodges_lehmann)#, '\nr = ', r)
ggplot() +
geom_violin(data=df_pareado, aes(x=as.factor(acreditacao), y=df_pareado$score, fill=as.factor(acreditacao)), show.legend = F, alpha=0.2) +
geom_boxplot(data=df_pareado, aes(x=as.factor(acreditacao), y=df_pareado$score, fill=as.factor(acreditacao)), alpha=0.90, show.legend = F, width = 0.5, fill = 'white') +
geom_errorbar(data=df_pareado, aes(x=as.factor(acreditacao), y=df_pareado$score, fill=as.factor(acreditacao)), stat = "summary", fun.data = "mean_se", width= 0.14, color="pink") +
geom_line(data=df_pareado, aes(x=as.factor(acreditacao), y=df_pareado$score, fill=as.factor(acreditacao), group=Unidade)) +
geom_point(data=df_pareado, aes(x=as.factor(acreditacao), y=df_pareado$score, fill=as.factor(acreditacao)), size=2, shape=21) +
annotate("text", x = 1.5, y = max(df_pareado$score,na.rm = T), label = texto_dentro_do_grafico, vjust = 0.7, size = 4, color = "black") +
labs(y='Score', title=adicionar_quebra_de_linha(titulo), x=eixo_x) +
theme(plot.title=element_text(face='italic'), axis.title=element_text(size=9, face='italic'),
legend.position = "bottom",axis.line = element_line(colour = "black")) +
theme_bw() +
scale_y_continuous(breaks=seq(from = 0,
to = max(df_pareado$score,na.rm = T),
by = round((max(df_pareado$score,na.rm = T) - min(df_pareado$score,na.rm = T))/10, 1)),
limits = c(min(df_pareado$score,na.rm = T), max(df_pareado$score,na.rm = T))) +
theme(axis.title.x = element_text(size = 11),
axis.title.y = element_text(size = 11)) + theme(legend.position = "none")
}
##############################################################################################
analise_grafica_pareada('SEÇÃO G2: Notificou algum evento nos ultimos 12 meses','SEÇÃO G: Notificou algum evento nos ultimos 12 meses')
ggsave("Notificação de evento.png", height=11, width=10, units="cm", dpi= 600)
analise_grafica_pareada('SEÇÃO H: 1.2 trabalha a mais de 1 ano no hospital?', 'SEÇÃO H: trabalha a mais de 1 ano no hospital?')
ggsave("Rotatividade de funcionarios.png", height=11, width=10, units="cm", dpi= 600)
analise_grafica_pareada('SEÇÃO H: 1.3 trabalha a mais de 5 anos no hospital?', 'TITULO - SEÇÃO H: 1.3 trabalha a mais de 5 anos no hospital?')
analise_grafica_pareada('SEÇÃO H: 3.2 Trabalha mais que 40horas semanais', 'TITULO - SEÇÃO H: 3.2 Trabalha mais que 40horas semanais')
analise_grafica_pareada('SEÇÃO H: 3.2 Trabalha mais que 60horas semanais', 'TITULO - SEÇÃO H: 3.2 Trabalha mais que 60horas semanais')
analise_grafica_pareada('SEÇÃO H: 3.2 Trabalha mais que 80horas semanais', 'TITULO - SEÇÃO H: 3.2 Trabalha mais que 80horas semanais')
analise_grafica_pareada('Nota Geral == Satisfatoria ?', 'TITULO - Nota Geral == Satisfatoria ?')
analise_grafica_pareada('Nota Geral == Boa ?', 'TITULO - Nota Geral == Boa ?')
analise_grafica_pareada('6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_0. Menos de 1 ano', 'TITULO - 6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_0. Menos de 1 ano')
analise_grafica_pareada('6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_1. 1 a 5 anos', 'TITULO - 6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_1. 1 a 5 anos')
analise_grafica_pareada('6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_2. 6 a 10 anos', 'TITULO - 6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_2. 6 a 10 anos')
analise_grafica_pareada('6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_3. 11 a 15 anos', 'TITULO - 6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_3. 11 a 15 anos')
analise_grafica_pareada('6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_4. 16 a 20 anos', 'TITULO - 6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_4. 16 a 20 anos')
analise_grafica_pareada('6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_5. 21 anos ou mais', 'TITULO - 6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_5. 21 anos ou mais')
##############################################################################################
analise_grafica_pareada('SEÇÃO H: 1.2 trabalha a mais de 1 ano no hospital?', 'Proporção de Profissionais a mais de uma Ano trabalhando no Hospital') +analise_grafica_pareada('SEÇÃO G2: Notificou algum evento nos ultimos 12 meses', 'Proporção de Profissionais que fizeram notificação nos ultimos 12 meses') + analise_grafica_pareada('Nota Geral == Satisfatoria ?', 'Proporção de nota Satisfatoria')
ggsave("Outros Graficos.png", height=11, width=30, units="cm", dpi=600)
#GERAL
(analise_grafica_pareada('Abertura de comunicação', 'Open communication') + analise_grafica_pareada('Feedback e comunicação sobre erros', 'Feedback and communication about errors') + analise_grafica_pareada('Frequência de eventos relatados', 'Frequency of reported events')) /
(analise_grafica_pareada('Apoio de gestão hospitalar para segurança do paciente', 'Hospital management support for patient safety') + analise_grafica_pareada('Trabalho em equipe entre as unidades hospitalares', 'Teamwork between hospital units') + analise_grafica_pareada('Trabalho em equipe no âmbito das unidades', 'Teamwork within units')) /
(analise_grafica_pareada('Transferências internas e passagens de plantão', 'Internal transfers and shift changes') + analise_grafica_pareada('Aprendizado organizacional - melhoria contínua', 'Organizational learning - continuous improvement') + analise_grafica_pareada('Expectativas de promoção da segurança dos supervisores e gerentes', 'Expectations for promoting safety by supervisors and managers')) /
(analise_grafica_pareada('Percepção gerais sobre segurança', 'General perceptions about safety') + analise_grafica_pareada('Respostas não punitivas aos erros', 'Non-punitive responses to errors') + analise_grafica_pareada('Staffing', 'Staffing'))
ggsave("Agrupamentos2.png", height=44, width=30, units="cm", dpi=600)
# Abertura de comunicação
analise_grafica_pareada('24. Os funcionários falam voluntariamente se vêem algo que possa afetar negativamente o atendimento aos pacientes', '24. Employees voluntarily speak up if they see something that may negatively affect patient care') +
analise_grafica_pareada('26. Os funcionários sentem-se à vontade para questionar decisões ou ações dos que têm mais autoridade', '26. Staff feel free to question the decisions or actions of those with more authority') +
analise_grafica_pareada('28. Os funcionários têm receio de perguntar quando algo não parece certo', '28. Staff are afraid to ask when something does not look right')
ggsave("Abertura de comunicação2.png", height=11, width=30, units="cm", dpi= 600)
# Feedback e comunicação sobre erros
analise_grafica_pareada('23. Recebemos feedback das mudanças implementadas com base nos eventos notificados', '23. We are given feedback about changes put into place based on event reports') +
analise_grafica_pareada('25. Somos informados sobre os erros que acontecem nesta unidade', '25. We are informed about errors that happen in this unit') +
analise_grafica_pareada('27. Nesta unidade, discutimos maneiras de impedir que os erros tornem a acontecer', '27. In this unit, we discuss ways to prevent errors from happening again')
ggsave("Feedback e comunicação sobre erros2.png", height=11, width=30, units="cm", dpi= 600)
# Frequência de eventos relatados
analise_grafica_pareada('29. Quando acontece um erro, mas ele é identificado e corrigido antes de afetar o paciente, com que frequência é notificado?', '29. When a mistake is made, but is caught and corrected before affecting the patient, how often is this reported?') +
analise_grafica_pareada('30. Quando acontece um erro, mas que não tem potencial de dano ao paciente, com que frequência é notificado?', '30. When a mistake is made, but has no potential to harm the patient, how often is this reported?') +
analise_grafica_pareada('31. Quando acontece um erro que poderia prejudicar o paciente, mas isto não ocorreu, com que frequência é notificado?', '31. When a mistake is made that could harm the patient, but does not, how often is this reported?')
ggsave("Frequencia de eventos relatados2.png", height=13, width=30, units="cm", dpi= 600)
# Apoio de gestão hospitalar para segurança do paciente
analise_grafica_pareada('32. A administração do hospital cria um ambiente de trabalho que promove a segurança do paciente', '32. Hospital management supports my daily efforts to keep patients safe') +
analise_grafica_pareada('39. As ações da administração do hospital mostram que a segurança do paciente é uma prioridade máxima', '39. Hospital management is doing a good job of keeping patient safety a top priority') +
analise_grafica_pareada('40. A administração do hospital parece se interessar pela segurança do paciente apenas quando acontece um evento adverso', '40. Hospital management seems interested in patient safety only after an adverse event happens')
ggsave("Apoio de gestão hospitalar para seguraça do paciente2.png", height=11, width=30, units="cm", dpi= 600)
# Trabalho em equipe entre as unidades hospitalares
(analise_grafica_pareada('33. As unidades hospitalares não se coordenam bem entre si.', '33. Hospital units do not coordinate well with each other.') +
analise_grafica_pareada('35. Existe uma boa cooperação entre as unidades hospitalares que precisam trabalhar juntas', '35. There is good cooperation among hospital units that need to work together.') +
analise_grafica_pareada('37. Muitas vezes é desagradável trabalhar unidades com funcionários de outras unidades do hospital', '37. It is often unpleasant to work with staff from other hospital units.')) /
(analise_grafica_pareada('41. As unidades do hospital trabalham bem juntas para prestar o melhor atendimento aos pacientes', '41. Hospital units work well together to provide the best care for patients.') + ggplot() + ggplot())
ggsave("Trabalho em equipe entre as unidades hospitalares2.png", height=22, width=30, units="cm", dpi= 600)
# Trabalho em equipe no âmbito das unidades
(analise_grafica_pareada('1. As pessoas se apoiam umas às outras nesta unidade', '1. People support one another in this unit.') +
analise_grafica_pareada('3. Quando há muito trabalho a ser feito e rapidamente, trabalhamos juntos em equipe para realizar a tarefa', '3. When a lot of work needs to be done quickly, we work together as a team to get the work done.') +
analise_grafica_pareada('4. Nesta unidade, as pessoas se tratam com respeito', '4. In this unit, people treat each other with respect.')) /
(analise_grafica_pareada('11. Quando uma área nesta unidade fica muito movimentada, as demais ajudam', '11. When one area in this unit gets busy, others help out.') + ggplot() + ggplot())
ggsave("Trabalho em equipe no âmbito das unidades2.png", height=22, width=30, units="cm", dpi= 600)
# Transferências internas e passagens de plantão
(analise_grafica_pareada('34. Coisas "escapam por entre os dedos” quando os pacientes são transferidos de uma unidade para outra', '34. Things "fall through the cracks" when patients are transferred from one unit to another.') +
analise_grafica_pareada('36. Importantes informações sobre a assistência se perdem durante as mudanças de turno', '36. Important information about care gets lost during shift changes.') +
analise_grafica_pareada('38. Os problemas com frequência ocorrem na troca de informações entre as unidades do hospital', '38. Problems often occur in the exchange of information across hospital units.')) /
(analise_grafica_pareada('42. As mudanças de turno são problemáticas para os pacientes deste Hospital', '42. Shift changes are problematic for patients in this Hospital.') + ggplot() + ggplot())
ggsave("Transferências internas e passagens de plantão2.png", height=22, width=30, units="cm", dpi= 600)
# Aprendizado organizacional - melhoria contínua
analise_grafica_pareada('6. Estamos ativamente buscando melhorias para a segurança do paciente', '6. We are actively working to improve patient safety.') +
analise_grafica_pareada('9. Erros que ocorreram levaram a mudanças positivas nesta unidade', '9. Mistakes have led to positive changes in this unit.') +
analise_grafica_pareada('13. Quando fazemos mudanças para melhorar a segurança do paciente, nós avaliamos sua efetividade', '13. When we make changes to improve patient safety, we evaluate their effectiveness.')
ggsave("Aprendizado organizacional - melhoria contínua2.png", height=11, width=30, units="cm", dpi= 600)
#Expectativas de promoção da segurança dos supervisores e gerentes
(analise_grafica_pareada('19. Meu supervisor/gerente elogia quando vê um trabalho feito de acordo com os procedimentos estabelecidos para a segurança do paciente.', '19. My supervisor/manager praises when seeing a job done according to the established procedures for patient safety.') + analise_grafica_pareada('20. Meu supervisor/gerente considera seriamente as sugestões dos funcionários para melhorar a segurança do paciente', '20. My supervisor/manager seriously considers employee suggestions to improve patient safety.') + analise_grafica_pareada('21. Sempre que a pressão aumenta, meu supervisor/gerente quer que trabalhemos mais rápido, mesmo que isto signifique tomar atalhos', '21. Whenever pressure increases, my supervisor/manager wants us to work faster, even if it means taking shortcuts.')) /
(analise_grafica_pareada('22. Meu supervisor/gerente ignora problemas recorrentes na segurança do paciente', '22. My supervisor/manager ignores recurring patient safety issues.') + ggplot() + ggplot())
ggsave("Expectativas de promoção da segurança dos supervisores e gerentes2.png", height=22, width=30, units="cm", dpi= 600)
#Percepção gerais sobre segurança
(analise_grafica_pareada('10. É apenas por acaso que erros mais sérios não acontecem por aqui', '10. It is just by chance that more serious errors do not happen here.') + analise_grafica_pareada('15. A segurança do paciente nunca é sacrificada em prol de se trabalhar mais', '15. Patient safety is never sacrificed for the sake of working more.') + analise_grafica_pareada('17. Temos problemas com a segurança do paciente nesta unidade', '17. We have problems with patient safety in this unit.')) /
(analise_grafica_pareada('18. Nossos procedimentos e sistemas são bons para impedir que os erros aconteçam', '18. Our procedures and systems are good at preventing errors from happening.') + ggplot() + ggplot())
ggsave("Percepção gerais sobre segurança2.png", height=22, width=30, units="cm", dpi= 600)
#Respostas não punitivas aos erros
analise_grafica_pareada('8. Os funcionários sentem que seus erros são usados contra eles', '8. Staff feel that their mistakes are held against them.') +
analise_grafica_pareada('12. Quando um evento é notificado, sentimos que o foco se concentra no indivíduo, e não no problema', '12. When an event is reported, it feels as if the focus is on the person, not the issue.') +
analise_grafica_pareada('16. Os funcionários se preocupam que seus erros sejam registrados em seu arquivo funcional', '16. Staff worry that their mistakes are kept in their personnel file.')
ggsave("Respostas não punitivas aos erros2.png", height=11, width=30, units="cm", dpi= 600)
#Staffing
(analise_grafica_pareada('2. Temos pessoas suficientes para lidar com o volume de trabalho', '2. We have enough staff to handle the workload.') +
analise_grafica_pareada('5. Os funcionários desta unidade trabalham mais horas do que o recomendado no atendimento a pacientes', '5. Staff in this unit work longer hours than is best for patient care.') +
analise_grafica_pareada('7. Utilizamos mais funcionários temporários do que o recomendado no atendimento a paciente', '7. We use more temporary staff than is best for patient care.')) /
(analise_grafica_pareada('14. Trabalhamos “em modo de crise”, tentando fazer coisas demais, rápido demais', '14. We work in "crisis mode", trying to do too much, too quickly.') + ggplot() + ggplot())
ggsave("Staffing2.png", height=22, width=30, units="cm", dpi= 600)
df_progresso = df %>% filter(passou_a_ser_acreditado == 1)
analise_grafica_pareada = function(coluna, titulo){
df_pareado = df_progresso %>% group_by(Unidade, acreditacao) %>% summarise(score = median(!!sym(coluna)))
df_pareado$acreditacao = factor(df_pareado$acreditacao, levels = c('No Accreditation', 'Accreditation'))
grupo = df_pareado$score
grupo0 = df_pareado$score[df_pareado$acreditacao == 'No Accreditation']
grupo1 = df_pareado$score[df_pareado$acreditacao == 'Accreditation']
#Teste de Hipotese - Teste Mann Whitney
teste_man = wilcox.test(grupo1,grupo0,conf.int = TRUE, paired=T)
man = retorne_p2(teste_man$p.value)
#Estimador Hodges Lehmann
estimador = as.character(round(teste_man$estimate,2))
IC_00 = as.character(round(teste_man$conf.int[1],2))
IC_01 = as.character(round(teste_man$conf.int[2],2))
hodges_lehmann = paste0(estimador,' [',IC_00,' to ',IC_01,']')
##Coeficiente r
##df_pareado[[coluna]] = 1 - df_pareado[[coluna]]
#teste = wilcoxonR(df_pareado$score, g=df_pareado$acreditacao, ci=T)
##df_pareado[[coluna]] = 1 - df_pareado[[coluna]]
#r = as.character(round(teste[1],2))
#r_ic0 = as.character(round(teste[2],2))
#r_ic1 = as.character(round(teste[3],2))
#r = paste0(r,' (',r_ic0,' to ',r_ic1,')')
#texto_dentro_do_grafico = paste0(man, '\n', "Diff in Location = ", hodges_lehmann, '\n', 'r = ', r)
texto_dentro_do_grafico = paste0(man)
eixo_x = paste0("Diff in Location = ", hodges_lehmann)#, '\nr = ', r)
ggplot() +
geom_violin(data=df_pareado, aes(x=as.factor(acreditacao), y=df_pareado$score, fill=as.factor(acreditacao)), show.legend = F, alpha=0.2) +
geom_boxplot(data=df_pareado, aes(x=as.factor(acreditacao), y=df_pareado$score, fill=as.factor(acreditacao)), alpha=0.90, show.legend = F, width = 0.5, fill = 'white') +
geom_errorbar(data=df_pareado, aes(x=as.factor(acreditacao), y=df_pareado$score, fill=as.factor(acreditacao)), stat = "summary", fun.data = "mean_se", width= 0.14, color="pink") +
geom_line(data=df_pareado, aes(x=as.factor(acreditacao), y=df_pareado$score, fill=as.factor(acreditacao), group=Unidade)) +
geom_point(data=df_pareado, aes(x=as.factor(acreditacao), y=df_pareado$score, fill=as.factor(acreditacao)), size=2, shape=21) +
annotate("text", x = 1.5, y = max(df_pareado$score,na.rm = T), label = texto_dentro_do_grafico, vjust = 0.7, size = 4, color = "black") +
labs(y='Score', title=adicionar_quebra_de_linha(titulo), x=eixo_x) +
theme(plot.title=element_text(face='italic'), axis.title=element_text(size=9, face='italic'),
legend.position = "bottom",axis.line = element_line(colour = "black")) +
theme_bw() +
scale_y_continuous(breaks=seq(from = 0,
to = max(df_pareado$score,na.rm = T),
by = round((max(df_pareado$score,na.rm = T) - min(df_pareado$score,na.rm = T))/10, 1)),
limits = c(min(df_pareado$score,na.rm = T), max(df_pareado$score,na.rm = T))) +
theme(axis.title.x = element_text(size = 11),
axis.title.y = element_text(size = 11)) + theme(legend.position = "none")
}
##############################################################################################
analise_grafica_pareada('SEÇÃO G2: Notificou algum evento nos ultimos 12 meses','SEÇÃO G: Notificou algum evento nos ultimos 12 meses')
ggsave("Notificação de evento.png", height=11, width=10, units="cm", dpi= 600)
analise_grafica_pareada('SEÇÃO H: 1.2 trabalha a mais de 1 ano no hospital?', 'SEÇÃO H: trabalha a mais de 1 ano no hospital?')
ggsave("Rotatividade de funcionarios.png", height=11, width=10, units="cm", dpi= 600)
analise_grafica_pareada('SEÇÃO H: 1.3 trabalha a mais de 5 anos no hospital?', 'TITULO - SEÇÃO H: 1.3 trabalha a mais de 5 anos no hospital?')
analise_grafica_pareada('SEÇÃO H: 3.2 Trabalha mais que 40horas semanais', 'TITULO - SEÇÃO H: 3.2 Trabalha mais que 40horas semanais')
analise_grafica_pareada('SEÇÃO H: 3.2 Trabalha mais que 60horas semanais', 'TITULO - SEÇÃO H: 3.2 Trabalha mais que 60horas semanais')
analise_grafica_pareada('SEÇÃO H: 3.2 Trabalha mais que 80horas semanais', 'TITULO - SEÇÃO H: 3.2 Trabalha mais que 80horas semanais')
analise_grafica_pareada('Nota Geral == Satisfatoria ?', 'TITULO - Nota Geral == Satisfatoria ?')
analise_grafica_pareada('Nota Geral == Boa ?', 'TITULO - Nota Geral == Boa ?')
analise_grafica_pareada('6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_0. Menos de 1 ano', 'TITULO - 6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_0. Menos de 1 ano')
analise_grafica_pareada('6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_1. 1 a 5 anos', 'TITULO - 6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_1. 1 a 5 anos')
analise_grafica_pareada('6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_2. 6 a 10 anos', 'TITULO - 6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_2. 6 a 10 anos')
analise_grafica_pareada('6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_3. 11 a 15 anos', 'TITULO - 6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_3. 11 a 15 anos')
analise_grafica_pareada('6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_4. 16 a 20 anos', 'TITULO - 6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_4. 16 a 20 anos')
analise_grafica_pareada('6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_5. 21 anos ou mais', 'TITULO - 6. Há quanto tempo você trabalha em sua profissão ou especialização atual?_5. 21 anos ou mais')
##############################################################################################
analise_grafica_pareada('SEÇÃO H: 1.2 trabalha a mais de 1 ano no hospital?', 'Proporção de Profissionais a mais de uma Ano trabalhando no Hospital') +analise_grafica_pareada('SEÇÃO G2: Notificou algum evento nos ultimos 12 meses', 'Proporção de Profissionais que fizeram notificação nos ultimos 12 meses') + analise_grafica_pareada('Nota Geral == Satisfatoria ?', 'Proporção de nota Satisfatoria')
ggsave("Outros Graficos.png", height=11, width=30, units="cm", dpi=600)
#GERAL
(analise_grafica_pareada('Abertura de comunicação', 'Open communication') + analise_grafica_pareada('Feedback e comunicação sobre erros', 'Feedback and communication about errors') + analise_grafica_pareada('Frequência de eventos relatados', 'Frequency of reported events')) /
(analise_grafica_pareada('Apoio de gestão hospitalar para segurança do paciente', 'Hospital management support for patient safety') + analise_grafica_pareada('Trabalho em equipe entre as unidades hospitalares', 'Teamwork between hospital units') + analise_grafica_pareada('Trabalho em equipe no âmbito das unidades', 'Teamwork within units')) /
(analise_grafica_pareada('Transferências internas e passagens de plantão', 'Internal transfers and shift changes') + analise_grafica_pareada('Aprendizado organizacional - melhoria contínua', 'Organizational learning - continuous improvement') + analise_grafica_pareada('Expectativas de promoção da segurança dos supervisores e gerentes', 'Expectations for promoting safety by supervisors and managers')) /
(analise_grafica_pareada('Percepção gerais sobre segurança', 'General perceptions about safety') + analise_grafica_pareada('Respostas não punitivas aos erros', 'Non-punitive responses to errors') + analise_grafica_pareada('Staffing', 'Staffing'))
ggsave("Agrupamentos2.png", height=44, width=30, units="cm", dpi=600)
# Abertura de comunicação
analise_grafica_pareada('24. Os funcionários falam voluntariamente se vêem algo que possa afetar negativamente o atendimento aos pacientes', '24. Employees voluntarily speak up if they see something that may negatively affect patient care') +
analise_grafica_pareada('26. Os funcionários sentem-se à vontade para questionar decisões ou ações dos que têm mais autoridade', '26. Staff feel free to question the decisions or actions of those with more authority') +
analise_grafica_pareada('28. Os funcionários têm receio de perguntar quando algo não parece certo', '28. Staff are afraid to ask when something does not look right')
ggsave("Abertura de comunicação2.png", height=11, width=30, units="cm", dpi= 600)
# Feedback e comunicação sobre erros
analise_grafica_pareada('23. Recebemos feedback das mudanças implementadas com base nos eventos notificados', '23. We are given feedback about changes put into place based on event reports') +
analise_grafica_pareada('25. Somos informados sobre os erros que acontecem nesta unidade', '25. We are informed about errors that happen in this unit') +
analise_grafica_pareada('27. Nesta unidade, discutimos maneiras de impedir que os erros tornem a acontecer', '27. In this unit, we discuss ways to prevent errors from happening again')
ggsave("Feedback e comunicação sobre erros2.png", height=11, width=30, units="cm", dpi= 600)
# Frequência de eventos relatados
analise_grafica_pareada('29. Quando acontece um erro, mas ele é identificado e corrigido antes de afetar o paciente, com que frequência é notificado?', '29. When a mistake is made, but is caught and corrected before affecting the patient, how often is this reported?') +
analise_grafica_pareada('30. Quando acontece um erro, mas que não tem potencial de dano ao paciente, com que frequência é notificado?', '30. When a mistake is made, but has no potential to harm the patient, how often is this reported?') +
analise_grafica_pareada('31. Quando acontece um erro que poderia prejudicar o paciente, mas isto não ocorreu, com que frequência é notificado?', '31. When a mistake is made that could harm the patient, but does not, how often is this reported?')
ggsave("Frequencia de eventos relatados2.png", height=13, width=30, units="cm", dpi= 600)
# Apoio de gestão hospitalar para segurança do paciente
analise_grafica_pareada('32. A administração do hospital cria um ambiente de trabalho que promove a segurança do paciente', '32. Hospital management supports my daily efforts to keep patients safe') +
analise_grafica_pareada('39. As ações da administração do hospital mostram que a segurança do paciente é uma prioridade máxima', '39. Hospital management is doing a good job of keeping patient safety a top priority') +
analise_grafica_pareada('40. A administração do hospital parece se interessar pela segurança do paciente apenas quando acontece um evento adverso', '40. Hospital management seems interested in patient safety only after an adverse event happens')
ggsave("Apoio de gestão hospitalar para seguraça do paciente2.png", height=11, width=30, units="cm", dpi= 600)
# Trabalho em equipe entre as unidades hospitalares
(analise_grafica_pareada('33. As unidades hospitalares não se coordenam bem entre si.', '33. Hospital units do not coordinate well with each other.') +
analise_grafica_pareada('35. Existe uma boa cooperação entre as unidades hospitalares que precisam trabalhar juntas', '35. There is good cooperation among hospital units that need to work together.') +
analise_grafica_pareada('37. Muitas vezes é desagradável trabalhar unidades com funcionários de outras unidades do hospital', '37. It is often unpleasant to work with staff from other hospital units.')) /
(analise_grafica_pareada('41. As unidades do hospital trabalham bem juntas para prestar o melhor atendimento aos pacientes', '41. Hospital units work well together to provide the best care for patients.') + ggplot() + ggplot())
ggsave("Trabalho em equipe entre as unidades hospitalares2.png", height=22, width=30, units="cm", dpi= 600)
# Trabalho em equipe no âmbito das unidades
(analise_grafica_pareada('1. As pessoas se apoiam umas às outras nesta unidade', '1. People support one another in this unit.') +
analise_grafica_pareada('3. Quando há muito trabalho a ser feito e rapidamente, trabalhamos juntos em equipe para realizar a tarefa', '3. When a lot of work needs to be done quickly, we work together as a team to get the work done.') +
analise_grafica_pareada('4. Nesta unidade, as pessoas se tratam com respeito', '4. In this unit, people treat each other with respect.')) /
(analise_grafica_pareada('11. Quando uma área nesta unidade fica muito movimentada, as demais ajudam', '11. When one area in this unit gets busy, others help out.') + ggplot() + ggplot())
ggsave("Trabalho em equipe no âmbito das unidades2.png", height=22, width=30, units="cm", dpi= 600)
# Transferências internas e passagens de plantão
(analise_grafica_pareada('34. Coisas "escapam por entre os dedos” quando os pacientes são transferidos de uma unidade para outra', '34. Things "fall through the cracks" when patients are transferred from one unit to another.') +
analise_grafica_pareada('36. Importantes informações sobre a assistência se perdem durante as mudanças de turno', '36. Important information about care gets lost during shift changes.') +
analise_grafica_pareada('38. Os problemas com frequência ocorrem na troca de informações entre as unidades do hospital', '38. Problems often occur in the exchange of information across hospital units.')) /
(analise_grafica_pareada('42. As mudanças de turno são problemáticas para os pacientes deste Hospital', '42. Shift changes are problematic for patients in this Hospital.') + ggplot() + ggplot())
ggsave("Transferências internas e passagens de plantão2.png", height=22, width=30, units="cm", dpi= 600)
# Aprendizado organizacional - melhoria contínua
analise_grafica_pareada('6. Estamos ativamente buscando melhorias para a segurança do paciente', '6. We are actively working to improve patient safety.') +
analise_grafica_pareada('9. Erros que ocorreram levaram a mudanças positivas nesta unidade', '9. Mistakes have led to positive changes in this unit.') +
analise_grafica_pareada('13. Quando fazemos mudanças para melhorar a segurança do paciente, nós avaliamos sua efetividade', '13. When we make changes to improve patient safety, we evaluate their effectiveness.')
ggsave("Aprendizado organizacional - melhoria contínua2.png", height=11, width=30, units="cm", dpi= 600)
#Expectativas de promoção da segurança dos supervisores e gerentes
(analise_grafica_pareada('19. Meu supervisor/gerente elogia quando vê um trabalho feito de acordo com os procedimentos estabelecidos para a segurança do paciente.', '19. My supervisor/manager praises when seeing a job done according to the established procedures for patient safety.') + analise_grafica_pareada('20. Meu supervisor/gerente considera seriamente as sugestões dos funcionários para melhorar a segurança do paciente', '20. My supervisor/manager seriously considers employee suggestions to improve patient safety.') + analise_grafica_pareada('21. Sempre que a pressão aumenta, meu supervisor/gerente quer que trabalhemos mais rápido, mesmo que isto signifique tomar atalhos', '21. Whenever pressure increases, my supervisor/manager wants us to work faster, even if it means taking shortcuts.')) /
(analise_grafica_pareada('22. Meu supervisor/gerente ignora problemas recorrentes na segurança do paciente', '22. My supervisor/manager ignores recurring patient safety issues.') + ggplot() + ggplot())
ggsave("Expectativas de promoção da segurança dos supervisores e gerentes2.png", height=22, width=30, units="cm", dpi= 600)
#Percepção gerais sobre segurança
(analise_grafica_pareada('10. É apenas por acaso que erros mais sérios não acontecem por aqui', '10. It is just by chance that more serious errors do not happen here.') + analise_grafica_pareada('15. A segurança do paciente nunca é sacrificada em prol de se trabalhar mais', '15. Patient safety is never sacrificed for the sake of working more.') + analise_grafica_pareada('17. Temos problemas com a segurança do paciente nesta unidade', '17. We have problems with patient safety in this unit.')) /
(analise_grafica_pareada('18. Nossos procedimentos e sistemas são bons para impedir que os erros aconteçam', '18. Our procedures and systems are good at preventing errors from happening.') + ggplot() + ggplot())
ggsave("Percepção gerais sobre segurança2.png", height=22, width=30, units="cm", dpi= 600)
#Respostas não punitivas aos erros
analise_grafica_pareada('8. Os funcionários sentem que seus erros são usados contra eles', '8. Staff feel that their mistakes are held against them.') +
analise_grafica_pareada('12. Quando um evento é notificado, sentimos que o foco se concentra no indivíduo, e não no problema', '12. When an event is reported, it feels as if the focus is on the person, not the issue.') +
analise_grafica_pareada('16. Os funcionários se preocupam que seus erros sejam registrados em seu arquivo funcional', '16. Staff worry that their mistakes are kept in their personnel file.')
ggsave("Respostas não punitivas aos erros2.png", height=11, width=30, units="cm", dpi= 600)
#Staffing
(analise_grafica_pareada('2. Temos pessoas suficientes para lidar com o volume de trabalho', '2. We have enough staff to handle the workload.') +
analise_grafica_pareada('5. Os funcionários desta unidade trabalham mais horas do que o recomendado no atendimento a pacientes', '5. Staff in this unit work longer hours than is best for patient care.') +
analise_grafica_pareada('7. Utilizamos mais funcionários temporários do que o recomendado no atendimento a paciente', '7. We use more temporary staff than is best for patient care.')) /
(analise_grafica_pareada('14. Trabalhamos “em modo de crise”, tentando fazer coisas demais, rápido demais', '14. We work in "crisis mode", trying to do too much, too quickly.') + ggplot() + ggplot())
ggsave("Staffing2.png", height=22, width=30, units="cm", dpi= 600)
coluna = "1. As pessoas se apoiam umas às outras nesta unidade"
grupo0 = df[[coluna]][df$acreditacao == 0]
grupo1 = df[[coluna]][df$acreditacao == 1]
#Teste de Hipotese - Teste Mann Whitney
teste_man = wilcox.test(grupo1,grupo0,conf.int = TRUE)
grupo0
grupo1
setwd("C:/Users/Gabriel/Documents/CULTURA DE SEGURANÇA")
df <- read_excel("4 - Dados_Score_Ano_vs_Acreditacao_vs_Unidade.xlsx")
coluna = "1. As pessoas se apoiam umas às outras nesta unidade"
grupo0 = df[[coluna]][df$acreditacao == 0]
grupo1 = df[[coluna]][df$acreditacao == 1]
#Teste de Hipotese - Teste Mann Whitney
teste_man = wilcox.test(grupo1,grupo0,conf.int = TRUE)
man = retorne_p(teste_man$p.value)
#Estimador Hodges Lehmann
estimador = as.character(round(teste_man$estimate,2))
IC_00 = as.character(round(teste_man$conf.int[1],2))
IC_01 = as.character(round(teste_man$conf.int[2],2))
hodges_lehmann = paste0(estimador,' (',IC_00,' to ',IC_01,')')
hodges_lehmann
outer(grupo1, grupo0, FUN='-')
diff
diff = outer(grupo1, grupo0, FUN='-')
diff
median(diff)
hodges_lehmann
teste_man
median(diff)
diff
teste_man
coluna = "1. As pessoas se apoiam umas às outras nesta unidade"
grupo0 = df[[coluna]][df$acreditacao == 0]
grupo1 = df[[coluna]][df$acreditacao == 1]
#Teste de Hipotese - Teste Mann Whitney
teste_man = wilcox.test(grupo1,grupo0,conf.int = TRUE)
man = retorne_p(teste_man$p.value)
#Estimador Hodges Lehmann
estimador = as.character(round(teste_man$estimate,2))
IC_00 = as.character(round(teste_man$conf.int[1],2))
IC_01 = as.character(round(teste_man$conf.int[2],2))
hodges_lehmann = paste0(estimador,' (',IC_00,' to ',IC_01,')')
hodges_lehmann
teste_man
diff = outer(grupo1, grupo0, FUN='-')
median(diff)
coluna = "17. Temos problemas com a segurança do paciente nesta unidade"
grupo0 = df[[coluna]][df$acreditacao == 0]
grupo1 = df[[coluna]][df$acreditacao == 1]
#Teste de Hipotese - Teste Mann Whitney
teste_man = wilcox.test(grupo1,grupo0,conf.int = TRUE)
man = retorne_p(teste_man$p.value)
#Estimador Hodges Lehmann
estimador = as.character(round(teste_man$estimate,2))
IC_00 = as.character(round(teste_man$conf.int[1],2))
IC_01 = as.character(round(teste_man$conf.int[2],2))
hodges_lehmann = paste0(estimador,' (',IC_00,' to ',IC_01,')')
hodges_lehmann
teste_man
diff = outer(grupo1, grupo0, FUN='-')
median(diff)
coluna = "17. Temos problemas com a segurança do paciente nesta unidade"
grupo0 = df[[coluna]][df$acreditacao == 0]
grupo1 = df[[coluna]][df$acreditacao == 1]
#Teste de Hipotese - Teste Mann Whitney
teste_man = wilcox.test(grupo1,grupo0,conf.int = TRUE, conf.level = 0.90)
man = retorne_p(teste_man$p.value)
#Estimador Hodges Lehmann
estimador = as.character(round(teste_man$estimate,2))
IC_00 = as.character(round(teste_man$conf.int[1],2))
IC_01 = as.character(round(teste_man$conf.int[2],2))
hodges_lehmann = paste0(estimador,' (',IC_00,' to ',IC_01,')')
hodges_lehmann
teste_man
diff = outer(grupo1, grupo0, FUN='-')
median(diff)
diff = outer(grupo1, grupo0, FUN='-')
grupo1
grupo0
diff = outer(grupo1, grupo0, FUN='-')
diff
median(diff)
coluna = "17. Temos problemas com a segurança do paciente nesta unidade"
grupo0 = df[[coluna]][df$acreditacao == 0]
grupo1 = df[[coluna]][df$acreditacao == 1]
#Teste de Hipotese - Teste Mann Whitney
teste_man = wilcox.test(grupo1,grupo0,conf.int = TRUE, conf.level = 0.90)
man = retorne_p(teste_man$p.value)
#Estimador Hodges Lehmann
estimador = as.character(round(teste_man$estimate,2))
IC_00 = as.character(round(teste_man$conf.int[1],2))
IC_01 = as.character(round(teste_man$conf.int[2],2))
hodges_lehmann = paste0(estimador,' (',IC_00,' to ',IC_01,')')
hodges_lehmann
#PARA FAZER:
library(RcmdrMisc) #summary diferenciado ==> numSummary()
##numSummary(df[,c("Peso")])$table %>% print() %>% write_clip(dec = ".", col.names = FALSE)
##numSummary(df[,c("Peso")], groups = df$Uso_ozempic)$table %>% print() %>% write_clip(dec = ".", col.names = FALSE)
#bibliotecas para extrair descrições das variaveis
library(purrr)
library(dplyr)
library(tidyr)
library(janitor) # tabelas de contagem ==> tabyl, adorn
library(clipr) #extrair tabelas ==> %>% write_clip(dec = ",", col.names = TRUE)
library(tableone) #criação de tabelas
library(lmtest)
library(RcmdrMisc) #summary diferenciado ==> numSummary(df[,c('coluna_numerica')], groups=df$'coluna_categorica')$table
library(RVAideMemoire) # shapiro por grupo ==> byf.shapiro(numerico~categorico, df)
#graficos
library(ggplot2)
library(cowplot) #graficos lado a lado ==> plot_grid(graf1, graf2, graf3, graf4, ncol=2, nrow=2)
library(patchwork)
library(magrittr)
library(scales) #escalas nos graficos
########### poucos usados
library(MatchIt) #para rodar Propensity Score
library(pROC) #curva roc ==> roc()
library(caret) #avaliação de ml (matrix confusão) ==> confusionMatrix()
library(forestmodel) #grafico forestplot
library(psych) # matrix de correlação==> pairs.panels(matrix)
###########
library(DescTools) #==> PseudoR2(mod, which='Nagelkerke')
library(QuantPsyc) #ClassLog
library(rcompanion) # ==> compareGLM(mod3, mod4)
#forestplot
library(sjPlot)
library(sjlabelled)
library(sjmisc)
# ==> plot_model(modelo, show.values = TRUE, value.offset = .3)
library(gridExtra)
library(vegan) #transformação de variaveis
library(exact2x2) # qui-quadrado pareado #ajuste para variaveis pequena
library(stringr) #para quando o texto inicia com letra minuscula #tabela$V1 = str_to_title(tabela$V1)
library(naniar) #analise de dados ausentes
library(readxl) #importar arquivo xlsx
library(skimr)
library(vcd) #coefientes de tamanho de efeito para cruzamento categorico (CRAMER, PHI, COEF CONTI)
library(effsize)
library(epitools)
library(epiR)
library(dplyr)
library(car)
library(rstatix)
library(DescTools)
library(emmeans)
library(ggplot2)
library(ggpubr)
df
setwd("C:/Users/Gabriel/Documents/CULTURA DE SEGURANÇA")
df <- read_excel("0 - Dados Limpos.xlsx")
set.seed(123)  # Defina uma semente para reprodutibilidade
indices_aleatorios <- sample(1:nrow(df), 200)
df <- df[indices_aleatorios, ]
df
for (coluna in names(df)){
if (class(df[[coluna]]) == 'numeric'){
print(paste('numeric ->',coluna))
}
else{
print(paste('factor ->',coluna))
}
}
for (coluna in names(df)){
if (class(df[[coluna]]) == 'numeric'){
print(paste('numeric ->',coluna))
if ( length(levels(as.factor(df[[coluna]]))) <= 2){
print(paste('numeric for factor ->',coluna))
}
}
else{
print(paste('factor ->',coluna))
}
}
for (coluna in names(df)){
if (class(df[[coluna]]) == 'numeric'){
if ( length(levels(as.factor(df[[coluna]]))) <= 2 ){
print(paste('numeric for factor ->',coluna))
}
else {
print(paste('numeric ->',coluna))
}
}
else{
print(paste('factor ->',coluna))
}
}
df$Ano = as.factor(df$Ano)
variaveis_analisaveis = names(df)
analise_univariada_completa(coluna_escolhida) %>% write_clip(dec = ",", col.names = TRUE)
coluna_escolhida = 'SEÇÃO G2: Notificou algum evento nos ultimos 12 meses'
df[[coluna_escolhida]]
impecilios = c(which(names(df) == coluna_escolhida))
variaveis_analisaveis = names(df)[-impecilios]
analise_univariada_completa(coluna_escolhida) %>% write_clip(dec = ",", col.names = TRUE)
